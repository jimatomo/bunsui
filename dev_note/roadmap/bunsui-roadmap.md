# bunsui 開発ロードマップ

## プロジェクト概要
**bunsui**は、AWS Step Functions、Lambda、ECS on Fargateを活用したデータパイプラインのオーケストレーションを管理するTUIツールです。

### ビジョン
- AIと人間が協調してデータパイプラインを管理
- 軽量で高速なTUIによる直感的な操作
- セッション単位での柔軟なジョブ管理とリラン機能
- Infrastructure as Codeによる標準化されたリソース管理

## フェーズ1: 基礎設計とコアモジュール開発（4週間）

### 1.1 アーキテクチャ設計（1週間）
- [ ] 全体アーキテクチャ図の作成
- [ ] モジュール構成の設計
- [ ] データモデル設計（DynamoDB、S3のスキーマ）
- [ ] APIインターフェース設計

### 1.2 コア概念の実装（2週間）
- [ ] Session管理モジュール
  - セッションのライフサイクル管理
  - 状態の永続化（DynamoDB）
- [ ] Pipeline/Job/Operation モデルの実装
  - DAG構造の実装
  - ジョブの依存関係管理
- [ ] メタデータ管理システム
  - S3へのログ保存機構
  - DynamoDBへのステータス記録

### 1.3 AWS統合基盤（1週間）
- [ ] boto3ラッパーの実装
- [ ] Step Functions操作モジュール
- [ ] Lambda/ECS操作モジュール
- [ ] エラーハンドリング機構

### 1.4 オフラインモードの充実化
- [ ] オフラインモードで設定ファイルの書き方をチェックできる
- [ ] オフラインモードの本格的なオーケストレーション機能は別モジュールに切り出して、本当にS3の代わりにローカルのファイルシステムを使いローカル盤のDynamoDBなどを利用してパイプラインの実行をできるようにする。（別軸でロードマップを策定するところまで）

## フェーズ2: TUI開発とCLI基盤（4週間）

### 2.1 Textual TUI実装（2週間）
- [ ] メイン画面レイアウト
  - パイプライン一覧ビュー
  - ジョブ詳細ビュー
  - 実行ログビュー
- [ ] インタラクティブ操作
  - ジョブの実行/停止
  - リラン機能
  - フィルタリング/検索

### 2.2 CLI基盤（1週間）
- [ ] コマンド体系の設計
- [ ] Click/Typerによる実装
- [ ] 設定ファイル管理

### 2.3 監視・通知機能（1週間）
- [ ] リアルタイム状態監視
- [ ] エラー検知とアラート
- [ ] 実行履歴の可視化

## フェーズ3: Infrastructure as Code（3週間）

### 3.1 リソース定義DSL（2週間）
- [ ] Pythonベースのリソース定義API
- [ ] Step Functions定義の抽象化
- [ ] Lambda/ECS設定の標準化
- [ ] IAMポリシー生成

### 3.2 CloudFormation生成（1週間）
- [ ] テンプレート生成エンジン
- [ ] パラメータ管理
- [ ] スタック管理機能

## フェーズ4: AI統合機能（4週間）

### 4.1 AI操作インターフェース（2週間）
- [ ] AI向けCLI API設計
- [ ] 操作コマンドの実装
  - ジョブステータス照会
  - リラン実行
  - エラー分析
- [ ] レスポンスフォーマット標準化

### 4.2 AI協調機能（2週間）
- [ ] エラー原因分析支援
- [ ] 自動復旧提案機能
- [ ] 実行計画の最適化提案
- [ ] チャット形式の対話インターフェース

## フェーズ5: レポート機能と高度な機能（3週間）

### 5.1 レポート生成（1週間）
- [ ] HTMLレポートテンプレート
- [ ] 実行結果の集計・可視化
- [ ] S3への自動アップロード

### 5.2 高度なリラン機能（1週間）
- [ ] チェックポイント管理
- [ ] 部分実行のスキップロジック
- [ ] 依存関係を考慮したリラン

### 5.3 パフォーマンス最適化（1週間）
- [ ] 大規模パイプライン対応
- [ ] キャッシュ機構
- [ ] 非同期処理の最適化

## フェーズ6: 本番環境対応と運用機能（3週間）

### 6.1 セキュリティ強化（1週間）
- [ ] 認証・認可機能
- [ ] 監査ログ
- [ ] 機密情報の暗号化

### 6.2 運用支援機能（1週間）
- [ ] バックアップ/リストア
- [ ] マイグレーション機能
- [ ] メンテナンスモード

### 6.3 ドキュメント整備（1週間）
- [ ] ユーザーガイド
- [ ] API/CLIリファレンス
- [ ] 運用マニュアル

## 技術スタック

### コア技術
- **言語**: Python 3.11+
- **TUI**: Textual
- **AWS SDK**: boto3
- **CLI**: Click/Typer

### AWS サービス
- **オーケストレーション**: Step Functions
- **コンピュート**: Lambda, ECS on Fargate
- **ストレージ**: S3, DynamoDB
- **スケジューリング**: EventBridge Scheduler
- **IaC**: CloudFormation

### データストレージ設計
- **DynamoDB**
  - セッション管理テーブル
  - ジョブ実行履歴テーブル
  - パイプラインメタデータテーブル
- **S3**
  - 実行ログストレージ
  - レポート保存
  - 設定ファイル管理

## モジュール構成

```
bunsui/
├── core/
│   ├── models/          # データモデル
│   ├── session/         # セッション管理
│   ├── pipeline/        # パイプライン管理
│   └── storage/         # ストレージ抽象化
├── aws/
│   ├── stepfunctions/   # Step Functions操作
│   ├── compute/         # Lambda/ECS操作
│   └── iac/            # CloudFormation生成
├── tui/
│   ├── screens/        # 画面定義
│   ├── widgets/        # カスタムウィジェット
│   └── handlers/       # イベントハンドラ
├── cli/
│   ├── commands/       # CLIコマンド
│   └── ai_interface/   # AI向けAPI
├── reporting/
│   └── html/          # HTMLレポート生成
└── utils/
    ├── logging/       # ロギング
    └── config/        # 設定管理
```

## マイルストーン

1. **M1（6週間後）**: コア機能とTUIの基本実装完了
2. **M2（10週間後）**: IaC機能とAI統合の基礎完了
3. **M3（13週間後）**: 全機能実装完了
4. **M4（16週間後）**: 本番環境対応完了、v1.0リリース

## リスクと対策

### 技術的リスク
- **大規模パイプラインのパフォーマンス**
  - 対策: 段階的な最適化、ページネーション実装
- **AWS APIレート制限**
  - 対策: リトライ機構、キャッシング

### 運用リスク
- **既存システムとの統合**
  - 対策: 段階的な移行パス提供
- **学習曲線**
  - 対策: 充実したドキュメント、サンプル提供

---

*最終更新: 2024-01-XX* 